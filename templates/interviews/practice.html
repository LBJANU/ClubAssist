{% extends 'main/base.html' %}

{% block title %}Practice: {{ question.title }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Question Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-michigan-blue mb-2">{{ question.title }}</h1>
        <div class="flex items-center mb-2">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mr-2">
                {{ question.get_difficulty_display }}
            </span>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 mr-2">
                {{ question.get_question_type_display }}
            </span>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                {{ club.name }}
            </span>
        </div>
        <p class="text-gray-600">{{ question.question_text }}</p>
    </div>

    <!-- Progress Status -->
    <div class="mb-6">
        {% if question_progress.completed %}
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-green-100 text-green-800 font-medium">Completed</span>
        {% elif question_progress.attempted %}
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-yellow-100 text-yellow-800 font-medium">Attempted</span>
        {% else %}
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full bg-gray-100 text-gray-800 font-medium">Not Started</span>
        {% endif %}
        <!-- {% if question_progress.completed_at %}
            <span class="ml-4 text-sm text-gray-500">Completed at: {{ question_progress.completed_at|date:"M d, Y H:i" }}</span>
        {% elif question_progress.attempted_at %}
            <span class="ml-4 text-sm text-gray-500">Attempted at: {{ question_progress.attempted_at|date:"M d, Y H:i" }}</span>
        {% endif %} -->
    </div>

    <!-- Practice Form -->
    <form method="post" class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8">
        {% csrf_token %}
        <div class="mb-6">
            <label for="user_answer" class="block text-sm font-medium text-gray-700 mb-2">Your Answer</label>
            <textarea name="user_answer" id="user_answer" rows="7" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-michigan-blue" placeholder="Type your answer here...">{{ question_progress.user_answer }}</textarea>
        </div>
        <div class="mb-6">
            <label for="notes" class="block text-sm font-medium text-gray-700 mb-2">Your Notes (optional)</label>
            <textarea name="notes" id="notes" rows="2" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-michigan-blue" placeholder="Add any notes or thoughts...">{{ question_progress.notes }}</textarea>
        </div>
        <div class="flex items-center space-x-4">
            <button type="submit" class="bg-michigan-blue text-white px-6 py-2 rounded-lg font-medium hover:bg-michigan-blue/90 transition-colors">
                {% if question_progress.completed %}Update Answer{% else %}Submit Answer{% endif %}
            </button>
            {% if question.sample_answer %}
                <button type="button" onclick="document.getElementById('sample-answer').classList.toggle('hidden')" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors">
                    Show Sample Answer
                </button>
            {% endif %}
        </div>
    </form>

    {% if question.sample_answer %}
        <div id="sample-answer" class="hidden bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8">
            <h3 class="font-semibold text-michigan-blue mb-2">Sample Answer</h3>
            <p class="text-gray-700">{{ question.sample_answer }}</p>
        </div>
    {% endif %}

    {% if question.hints %}
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-8">
            <h3 class="font-semibold text-yellow-700 mb-2">Hint</h3>
            <p class="text-gray-700">{{ question.hints }}</p>
        </div>
    {% endif %}

    <a href="{% url 'clubs:prep' club.id %}" class="inline-block mt-4 text-michigan-blue hover:underline">&larr; Back to Question Bank</a>
</div>
{% endblock %} 